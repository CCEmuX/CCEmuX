import groovy.json.JsonSlurper

plugins {
	id 'java'
	id 'application'
	id 'com.github.johnrengelman.shadow' version '2.0.0'
	id 'eclipse'
	id 'idea'
}

group = 'net.clgd'
version = '1.0-SNAPSHOT'

mainClassName = 'net.clgd.ccemux.init.Launcher'

sourceCompatibility = 1.8
targetCompatibility = 1.8

eclipse.project {
	natures 'org.eclipse.buildship.core.gradleprojectnature'
	natures 'org.springsource.ide.eclipse.gradle.core.nature'
}

repositories {
	mavenCentral()

	maven {
		name = 'computercraft'
		url = "https://cc.crzd.me/maven"
	}

	maven {
		name = "squiddev"
		url = "https://dl.bintray.com/squiddev/maven"
	}

	maven {
		name = "snapshots"
		url = "https://oss.sonatype.org/content/repositories/snapshots/"
	}
}

project.ext.lombokVersion = '1.16.18'

dependencies {
	compileOnly "org.projectlombok:lombok:${lombokVersion}"
	testCompileOnly "org.projectlombok:lombok:${lombokVersion}"

	compileOnly 'com.google.auto.service:auto-service:1.0-rc3'

	compile "dan200.computercraft:ComputerCraft:1.80pr0-build0"

	compile 'org.slf4j:slf4j-api:1.7.25'
	compile 'org.apache.logging.log4j:log4j-slf4j-impl:2.8.2'
	compile 'org.apache.logging.log4j:log4j-core:2.8.2'

	compile 'commons-io:commons-io:2.5'
	compile 'commons-cli:commons-cli:1.4'
	compile 'commons-codec:commons-codec:1.10'
	compile 'org.apache.commons:commons-lang3:3.6'

	compile 'org.squiddev:cctweaks-lua:1.5.0-nightly-build0'

	compile 'com.google.guava:guava:22.0'
	compile 'com.google.code.gson:gson:2.8.1'

	testCompile 'junit:junit:4.12'
}

processResources {
	exclude '**/*.xcf' // GIMP images
}

jar {
	manifest {
		attributes 'SplashScreen-Image': 'img/splash2.gif', 'Implementation-Version': version
	}
}

shadowJar {
	classifier = null

	exclude '*.html'
	exclude 'META-INF/maven/*/*/*.*'
}

run {
	standardInput = System.in
}

runShadow {
	standardInput = System.in
}

build.dependsOn shadowJar
